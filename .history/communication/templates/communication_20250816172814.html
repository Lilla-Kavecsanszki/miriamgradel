{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block body_class %}template-communication{% endblock %}

{% block content %}
<section class="container my-5">
  <h1 class="mb-3">{{ page.title }}</h1>
  {% if page.intro %}<div class="lead mb-4">{{ page.intro|richtext }}</div>{% endif %}

  {# ===== Services grid (one card per service) ===== #}
  <div class="row">
    {% for blk in page.services %}
      {% if blk.block_type == "service" %}
      <div class="col-md-6 col-lg-4 mb-4" id="{{ blk.value.slug|default:blk.value.title|slugify }}">
        <div class="card h-100 border-0 shadow-sm">
          {% if blk.value.image %}
            {% image blk.value.image fill-600x360 class="card-img-top" %}
          {% endif %}
          <div class="card-body d-flex flex-column">
            <h3 class="h5 mb-2">{{ blk.value.title }}</h3>
            <div class="mb-3 small text-muted">{{ blk.value.details|richtext }}</div>

            {% if blk.value.examples %}
              <h4 class="h6 mt-2">Examples / Projects</h4>
              <ul class="list-unstyled mb-3">
                {% for ex in blk.value.examples %}
                  <li class="mb-2 d-flex">
                    {% if ex.image %}
                      <div class="me-2" style="width:56px;height:56px;overflow:hidden;border-radius:.5rem;">
                        {% image ex.image fill-112x112 class="img-fluid" %}
                      </div>
                    {% endif %}
                    <div>
                      <div class="fw-semibold">{{ ex.title }}</div>
                      {% if ex.description %}<div class="small text-muted">{{ ex.description }}</div>{% endif %}
                      {% if ex.link_url and ex.link_label %}
                        <a class="small" href="{{ ex.link_url }}" target="_blank" rel="noopener">{{ ex.link_label }}</a>
                      {% endif %}
                    </div>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}

            {% if blk.value.outputs %}
              <h4 class="h6">Outputs / Tasks</h4>
              <ul class="list-group list-group-flush">
                {% for out in blk.value.outputs %}
                  <li class="list-group-item">{{ out }}</li>
                {% endfor %}
              </ul>
            {% endif %}
          </div>
        </div>
      </div>
      {% endif %}
    {% endfor %}
  </div>

  {# ===== Optional: Project highlights row ===== #}
  {% if page.project_highlights %}
    <hr class="my-5">
    <h2 class="h4 mb-3">Project highlights</h2>
    <div class="row">
      {% for hi in page.project_highlights %}
        {% if hi.block_type == "highlight" %}
          <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
              {% if hi.value.image %}
                {% image hi.value.image fill-600x360 class="card-img-top" %}
              {% endif %}
              <div class="card-body d-flex flex-column">
                <h3 class="h6">{{ hi.value.title }}</h3>
                {% if hi.value.description %}
                  <p class="small text-muted">{{ hi.value.description }}</p>
                {% endif %}
                {% if hi.value.link_url and hi.value.link_label %}
                  <a class="btn btn-outline-dark btn-sm mt-auto" href="{{ hi.value.link_url }}" target="_blank" rel="noopener">{{ hi.value.link_label }}</a>
                {% endif %}
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  {% endif %}
</section>
{% endblock %}
