{% load static wagtailcore_tags wagtailuserbar %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>
    {% block title %}
      {% if page.seo_title %}{{ page.seo_title }}{% else %}{{ page.title }}{% endif %}
    {% endblock %}
    {% block title_suffix %}
      {% wagtail_site as current_site %}
      {% if current_site and current_site.site_name %}- {{ current_site.site_name }}{% endif %}
    {% endblock %}
  </title>

  {% if page.search_description %}
    <meta name="description" content="{{ page.search_description }}" />
  {% endif %}
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  {% if request.in_preview_panel %}
    <base target="_blank">
  {% endif %}

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <!-- Favicon -->
  <link rel="icon" href="{% static 'favicon.ico' %}">

  <!-- Global CSS (sidebar + shared styles) -->
  <link rel="stylesheet" href="{% static 'css/base.css' %}">

  {% block extra_css %}{% endblock %}
</head>

<body class="{% block body_class %}{% endblock %}">
    {% wagtailuserbar %}
  <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <img src="{% static 'images/logo.png' %}" alt="Logo" loading="lazy" class="loading-logo">
    </div>

  {# ========== Sticky side menu (override this block to hide on welcome page) ========== #}
  {% block side_menu %}
    <aside id="side-menu" class="side-menu" aria-label="Site menu">
      <div class="menu-container">

        {# Logo → Home #}
        {% slugurl 'home' as home_url %}
        <a class="menu-logo" href="{{ home_url|default:'/' }}">
          <span class="logo-line">Miriam</span><br>
          <span class="logo-line">Gradel</span>
        </a>

        {# Pre-resolve page URLs used below #}
        {% slugurl 'written-page' as written_url %}
        {% slugurl 'audio-page' as audio_url %}
        {% slugurl 'video-page' as videos_url %}
        {% slugurl 'communication' as communication_url %}
        {% slugurl 'behind-the-scenes' as bts_url %}
        {% slugurl 'work-with-me' as work_url %}

        <nav class="main-menu">
          <ul class="menu-root">
            <li class="has-submenu">
              <button class="menu-toggle" aria-expanded="false" aria-controls="submenu-journalism">
                <span class="j-dropdown">Journalism</span>
                <span class="chevron" aria-hidden="true">▾</span>
              </button>

              <ul id="submenu-journalism" class="submenu" hidden>
                <li><a class="submenu-link{% if request.path == written_url %} is-active{% endif %}" href="{{ written_url }}">Written</a></li>
                <li><a class="submenu-link{% if request.path == audio_url %} is-active{% endif %}" href="{{ audio_url }}">Audio</a></li>
                <li><a class="submenu-link{% if request.path == videos_url %} is-active{% endif %}" href="{{ videos_url }}">Video</a></li>
              </ul>
            </li>

            <li class="divider"></li>
            <li><a class="menu-link" href="{{ communication_url }}">Communication</a></li>

            <li class="divider"></li>
            <li><a class="menu-link" href="{{ bts_url }}">Behind the Scenes</a></li>

            <li class="divider"></li>
            <li><a class="menu-link" href="{{ work_url }}">Work with Me</a></li>
          </ul>
        </nav>

        <div class="logo">
          <img src="{% static 'images/logo.png' %}" alt="Miriam Gradel logo" class="logo-img">
        </div>

        <div class="menu-bottom">
          {% comment %} <div class="lang-picker">
            <button class="lang-btn" type="button" aria-expanded="false">
              <span>En</span> <span class="chevron">▾</span>
            </button>
          </div> {% endcomment %}

          <div class="dot-row" role="group" aria-label="Social links">
            <!-- LinkedIn -->
            <a class="dot linkedin" href="https://www.linkedin.com" target="_blank" rel="noopener" aria-label="LinkedIn">
              <i class="fa-brands fa-linkedin-in" aria-hidden="true"></i>
            </a>

            <!-- Instagram -->
            <a class="dot insta" href="https://www.instagram.com" target="_blank" rel="noopener" aria-label="Instagram">
              <i class="fab fa-instagram" aria-hidden="true"></i>
            </a>

            <!-- Bluesky (using custom SVG) -->
            <a class="dot bluesky"
              href="https://bsky.app/profile/mgradel.bsky.social"
              target="_blank" rel="noopener"
              aria-label="Bluesky">
              <svg viewBox="-50 -70 430 390" aria-hidden="true" height="1.1em">
                <path d="M180 141.964C163.699 110.262 119.308 51.1817 78.0347 22.044C38.4971 -5.86834 23.414 -1.03207 13.526 3.43594C2.08093 8.60755 0 26.1785 0 36.5164C0 46.8542 5.66748 121.272 9.36416 133.694C21.5786 174.738 65.0603 188.607 105.104 184.156C107.151 183.852 109.227 183.572 111.329 183.312C109.267 183.642 107.19 183.924 105.104 184.156C46.4204 192.847 -5.69621 214.233 62.6582 290.33C137.848 368.18 165.705 273.637 180 225.702C194.295 273.637 210.76 364.771 295.995 290.33C360 225.702 313.58 192.85 254.896 184.158C252.81 183.926 250.733 183.645 248.671 183.315C250.773 183.574 252.849 183.855 254.896 184.158C294.94 188.61 338.421 174.74 350.636 133.697C354.333 121.275 360 46.8568 360 36.519C360 26.1811 357.919 8.61012 346.474 3.43851C336.586 -1.02949 321.503 -5.86576 281.965 22.0466C240.692 51.1843 196.301 110.262 180 141.964Z"
                      fill="#767676"></path>
              </svg>
            </a>

            <!-- Signal -->
            <a class="dot signal" href="https://signal.org" target="_blank" rel="noopener" aria-label="Signal">
              <i class="fa-solid fa-comment-dots" aria-hidden="true"></i>
            </a>

            <!-- Line -->
            <a class="dot line" href="https://www.line.me/en/" target="_blank" rel="noopener" aria-label="Line">
              <i class="fa-brands fa-line" aria-hidden="true"></i>
            </a>

            <!-- Email -->
            <a class="dot mail" href="mailto:your@email.com" aria-label="Email">
              <i class="fa-solid fa-at" aria-hidden="true"></i>
            </a>
          </div>
      </div>
    </aside>
  {% endblock %}

  <!-- Mobile Top Bar (optional) -->
  <div class="mobile-top-bar d-lg-none">
    <div class="brand">Miriam Gradel</div>
    <div class="mobile-actions">
      <button class="mobile-contact" aria-label="Contact">
        <div class="square-icon"></div>
        <span>Contact</span>
      </button>
      <button class="menu-open" aria-label="Open menu">☰</button>
    </div>
  </div>

  <!-- Page content -->
  <main>
    {% block content %}{% endblock %}
  </main>

  {# ========== FOOTER ========== #}
  <footer class="site-footer">
    <div class="footer-inner">
      {# Pre-resolve URLs used in the footer #}
      {% slugurl 'written-page' as written_url %}
      {% slugurl 'audio-page' as audio_url %}
      {% slugurl 'video-page' as videos_url %}
      {% slugurl 'communication' as communication_url %}
      {% slugurl 'behind-the-scenes' as bts_url %}
      {% slugurl 'work-with-me' as work_url %}

      <!-- Left: ownership + little squares -->
      <div class="footer-col footer-meta">
        <p class="m-0">The website is the property of <strong>Miriam Gradel</strong>.</p>
        <div class="footer-squares" aria-hidden="true">
          <span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>

      <!-- Middle: link columns -->
      <nav class="footer-col footer-nav footer-nav--right">
        <ul class="footer-links">
          <li><a href="{{ written_url|default:'#' }}">Written</a></li>
          <li><a href="{{ audio_url|default:'#' }}">Audio</a></li>
          <li><a href="{{ videos_url|default:'#' }}">Video</a></li>
        </ul>
      </nav>

      <nav class="footer-col footer-nav footer-nav--right">
        <ul class="footer-links">
          <li><a href="{{ communication_url|default:'#' }}">Communication</a></li>
          <li><a href="{{ bts_url|default:'#' }}">Behind the scene</a></li>
          <li><a href="{{ work_url|default:'#' }}">Work with me</a></li>
        </ul>
      </nav>

      <!-- Right: legal + dev credit -->
      <div class="footer-col footer-legal">
        <p class="m-0">All rights reserved.
          {% if page and page.last_published_at %}
            Updated in {{ page.last_published_at|date:"Y" }}.
          {% else %}
            Updated in {% now "Y" %}.
          {% endif %}
          No cookies are used.
        </p>
        <p class="dev-note m-0">Site by <a href="#" rel="noopener">Your Studio</a></p>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Global JS (submenu toggle, etc.) -->
  <script src="{% static 'js/miriamgradel.js' %}"></script>

  <!-- Custom JavaScript for Loading Overlay -->
    <script>
    window.addEventListener('load', function () {
        var overlay = document.getElementById('loading-overlay');
        
        // Fade out the overlay
        overlay.style.opacity = 0;
    
        overlay.addEventListener('transitionend', function() {
            overlay.style.display = 'none';
            document.querySelector('.content').style.display = 'block';
        });
    });
    </script>

  {% block extra_js %}{% endblock %}
</body>
</html>
