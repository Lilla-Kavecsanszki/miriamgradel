{% extends "base.html" %}
{% load static wagtailcore_tags wagtailimages_tags %}

{% block body_class %}template-work-with-me{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/work_with_me.css' %}">
{% endblock %}

{% block content %}
<section class="container my-5">

  <!-- Banner -->
  <div class="wme-banner mb-4">
    <div class="wme-banner__stripe"></div>
    <div class="wme-banner__title"><span>{{ page.greeting|default:"Work with me" }}</span></div>
  </div>

  {% if page.intro %}
    <div class="mb-4">{{ page.intro|richtext }}</div>
  {% endif %}

  {% if sent %}
    <div class="alert alert-success" role="alert">
      Thanks! Your message has been sent — I’ll get back to you shortly.
    </div>
  {% endif %}

  <div class="row g-4 align-items-start">

    <!-- Left: Contact form -->
    <div class="col-lg-7">
      <h2 class="wme-section__title mb-3"><span>Tell me about your project</span></h2>

      <form method="post" novalidate>
        {% csrf_token %}
        {{ form.hp }} {# honeypot #}

        <div class="mb-3">
          <label class="form-label" for="{{ form.name.id_for_label }}">Your name</label>
          <input type="text" name="{{ form.name.html_name }}" id="{{ form.name.id_for_label }}"
                 value="{{ form.name.value|default_if_none:'' }}" class="form-control wme-input" required>
          {% for e in form.name.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>

        <div class="mb-3">
          <label class="form-label" for="{{ form.email.id_for_label }}">Your email</label>
          <input type="email" name="{{ form.email.html_name }}" id="{{ form.email.id_for_label }}"
                 value="{{ form.email.value|default_if_none:'' }}" class="form-control wme-input" required>
          {% for e in form.email.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>

        <div class="mb-3">
          <label class="form-label" for="{{ form.subject.id_for_label }}">Subject (optional)</label>
          <input type="text" name="{{ form.subject.html_name }}" id="{{ form.subject.id_for_label }}"
                 value="{{ form.subject.value|default_if_none:'' }}" class="form-control wme-input">
          {% for e in form.subject.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>

        <div class="mb-3">
          <label class="form-label" for="{{ form.message.id_for_label }}">Message</label>
          <textarea name="{{ form.message.html_name }}" id="{{ form.message.id_for_label }}"
                    rows="6" class="form-control wme-input" required>{{ form.message.value|default_if_none:'' }}</textarea>
          {% for e in form.message.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
        </div>

        <button class="btn btn-dark" type="submit">Send message</button>
        {% if page.contact_email %}
          <div class="small text-muted mt-2">
            Prefer email? <a href="mailto:{{ page.contact_email }}">{{ page.contact_email }}</a>
          </div>
        {% endif %}
      </form>
    </div>

    <!-- Right: Portrait & direct contact -->
    <aside class="col-lg-5">
      <h2 class="wme-aside__title mb-3"><span>Contact details</span></h2>

      {% if page.portrait %}
        <div class="wme-portrait mb-3">
          {% image page.portrait fill-720x900 class="img-fluid rounded" alt="Portrait" %}
        </div>
      {% endif %}

      <ul class="list-unstyled">
        {% if page.phone_number %}
          <li class="mb-2"><strong>Phone:</strong> <a href="tel:{{ page.phone_number|cut:' ' }}">{{ page.phone_number }}</a></li>
        {% endif %}
        {% if page.contact_email %}
          <li class="mb-2"><strong>Email:</strong> <a href="mailto:{{ page.contact_email }}">{{ page.contact_email }}</a></li>
        {% endif %}
      </ul>

      {# Optional QR area (you have CSS ready) — add an Image field later if you want #}
      {# <div class="wme-qr mt-3">{% image page.qr_image original alt="Scan to email me" %}</div> #}
    </aside>
  </div>

</section>
{% endblock %}
