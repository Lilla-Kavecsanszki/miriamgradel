{% extends "base.html" %}
{% load static wagtailcore_tags wagtailimages_tags form_extras wme_qr %}

{% block body_class %}template-work-with-me{% endblock %}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/work_with_me.css' %}">
  <link rel="stylesheet" href="{% static 'css/journalism.css' %}">
{% endblock extra_css %}

{% block content %}
<div class="container-fluid py-4">
  <div class="row">
    <!-- ================= LEFT: hero + copy + form (col-8) ================= -->
    <div class="col-12 col-lg-8">

      <!-- Hero ribbon (same component used on Written page) -->
      <div class="written-hero mb-3">
        <span class="cap" aria-hidden="true"></span>
        <div class="block-title" style="color:#73f0fa">
          {{ page.greeting|default:"Work with me" }}
        </div>
      </div>

      <!-- Optional sub-head like your example banner -->
      <h3 class="section-title">15 years of impactful storytelling Journalism</span></h3>

      <!-- Lead / paragraph (optional) -->
      {% if page.intro %}<div class="mb-3">{{ page.intro|richtext }}</div>{% endif %}
      {% if page.bold_text %}<p>{{ page.bold_text|richtext }}</p>{% endif %}

      <!-- Form -->
      <h3 class="section-title mt-4">Letâ€™s talk</span></h3>

      <form action="{% pageurl page %}" method="post" novalidate>
        {% csrf_token %}

        <!-- First 3 fields in a row (Name / Surname / Email) -->
        <div class="row g-3">
          {% for field in form.visible_fields %}
            {% if forloop.counter0 < 3 %}
              <div class="col-12 col-md-4">
                {% include "work_with_me/_field.html" with field=field rows=1 placeholder="" %}
              </div>
            {% endif %}
          {% endfor %}
        </div>

        <!-- Remaining non-textarea fields full width (e.g., Subject) -->
        {% for field in form.visible_fields %}
          {% if forloop.counter0 >= 3 and field.field.widget.input_type != 'textarea' %}
            <div class="mt-3">
              {% include "work_with_me/_field.html" with field=field placeholder="" %}
            </div>
          {% endif %}
        {% endfor %}

        <!-- Message textarea (if present) -->
        {% for field in form.visible_fields %}
          {% if field.field.widget.input_type == 'textarea' %}
            <div class="mt-3">
              {% include "work_with_me/_field.html" with field=field rows=8 placeholder="" %}
            </div>
          {% endif %}
        {% endfor %}

        {% for hf in form.hidden_fields %}{{ hf }}{% endfor %}

        <div class="d-flex justify-content-end mt-2">
          <button class="btn btn-dark px-4" type="submit">Send</button>
        </div>
      </form>
    </div>

    <!-- ================= RIGHT: sidebar (col-4) ================= -->
    <div class="col-12 col-lg-4 mt-4 mt-lg-0">
      <aside class="bts-aside contact_aside">

        {% if page.portrait %}
          <div class="wme-portrait mb-3">
            {% image page.portrait fill-720x900 class="img-fluid rounded w-100" alt="Portrait" %}
          </div>
        {% endif %}
        <h3 class="section-title">For my contact details scan the QR code</h3>
        {% comment %} QR code for contact details {% endcomment %}
        {% wme_qr_svg page.get_qr_payload page.qr_scale as qr_svg %}
        {% if qr_svg %}
          <div class="wme-qr mb-2 text-center">{{ qr_svg }}</div>
          {% if page.vcard_file %}
            <p class="text-center mb-3">
              <a class="small text-decoration-underline" href="{{ page.vcard_file.url }}" download>
                Download vCard (.vcf)
              </a>
            </p>
          {% endif %}
        {% endif %}

        <ul class="list-unstyled small">
          {% if page.phone_number %}
            <li class="mb-2"><strong>Phone:</strong>
              <a href="tel:{{ page.phone_number|cut:' ' }}">{{ page.phone_number }}</a>
            </li>
          {% endif %}
          {% if page.contact_email or page.to_address %}
            <li class="mb-2"><strong>Email:</strong>
              <a href="mailto:{% firstof page.contact_email page.to_address %}">
                {% firstof page.contact_email page.to_address %}
              </a>
            </li>
          {% endif %}
        </ul>
      </aside>
    </div>
  </div>
</div>
{% endblock %}
